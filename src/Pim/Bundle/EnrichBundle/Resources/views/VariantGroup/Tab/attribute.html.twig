{% set orderedGroups = form.productTemplate.vars.orderedGroups %}

<div class="tab-pane product-edit tab-attribute {{ viewElement.loop.first ? 'active' : '' }}" id="{{ viewElement.alias|replace({' ': '-', '.': '-'})|lower }}">
    <div class="tab-groups">
        <ul class="nav nav-list">
            {% for group in orderedGroups if form.productTemplate.vars.groups[group.id] is defined %}
                <li class="tab{% if loop.index == 1 %} active{% endif %}">
                    <a href="#tabs-{{group.id}}" data-toggle="tab">{{ group.label }}</a>
                </li>
            {% endfor %}
        </ul>
    </div>
    <div class="tab-content">
        <div {{ comparisonLocale is not null ? 'class="compare" ' }}id="comparison-buttons">
            {% if comparisonLocale is not null %}
                <div id="copy-selection-switcher" class="btn-group pull-left">
                    <button class="btn dropdown-toggle" data-toggle="dropdown">
                        {{ 'Select'|trans }}
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu">
                        <li class="left-aligned"><a class="copy-selection" data-target="all" href="#">{{ 'All'|trans }}</a></li>
                        <li class="left-aligned"><a class="copy-selection" data-target="current-tab" href="#">{{ 'Current tab'|trans }}</a></li>
                        <li class="left-aligned"><a class="copy-selection" data-target="none" href="#">{{ 'None'|trans }}</a></li>
                    </ul>
                </div>
                <div class="btn-group"><a href="#" id="copy-selection" class="btn pull-left">{{ 'Copy'|trans }}</a></div>
            {% endif %}

            <div id="comparison-switcher" class="btn-group">
                <button class="btn dropdown-toggle" data-toggle="dropdown">
                    {{ 'Translate from'|trans }}{% if comparisonLocale is not null %}: {{ comparisonLocale|flag }}<span class="title">{{ locale_label(comparisonLocale) }}</span>{% endif %}
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu pull-right">
                    {% for locale in locales if locale != dataLocale %}
                        <li class="left-aligned{{ locale.code == comparisonLocale ? ' active' }}">
                            <a href="{{ path('pim_enrich_variant_group_edit', {id: form.vars.value.id, dataLocale: dataLocale, compareWith: locale.code}) }}" title="{{ locale_label(locale.code) }}">
                                <span class="indicator">
                                    {% if locale == comparisonLocale %}
                                        <i class="icon-circle"></i>
                                    {% endif %}
                                </span>
                                {{ locale.code|flag }}
                                <span class="title">{{ locale_label(locale.code) }}</span>
                            </a>
                        </li>
                    {% else %}
                        <li>
                            <a href="javascript:void(0);">
                                <span class="title">{{ 'pim_enrich.product.no_comparison_locale_available'|trans }}</span>
                            </a>
                        </li>
                    {% endfor %}
                </ul>
            </div>
            {% if comparisonLocale is not null %}
                <a href="{{ path('pim_enrich_variant_group_edit', {id: form.vars.value.id, dataLocale: dataLocale}) }}" class="btn">
                    &times;
                </a>
            {% endif %}
        </div>
        <div id="attribute-buttons">
            {% include 'PimEnrichBundle:VariantGroup:_locale-switcher.html.twig' %}
            {{ elements.channelSwitcher(channels) }}
        </div>

        {% for groupId, groupView in form.productTemplate.vars.groups %}
            <div id="tabs-{{ groupId }}" class="tab-pane fullheight">
                <h3>{{ groupView.label }}</h3>
                {% if comparisonLocale %}
                    {% include 'PimEnrichBundle:VariantGroup:_edit_with_comparison.html.twig' %}
                {% else %}
                    {% include 'PimEnrichBundle:VariantGroup:_edit_without_comparison.html.twig' %}
                {% endif %}
            </div>
        {% else %}
            <div class="tab-pane active fullheight">
                <h3>&nbsp;</h3>
                <div class="alert alert-info">
                    <div class="message">
                        {% if form.productTemplate.vars.data and form.productTemplate.vars.data.values|length %}
                            {{ 'pim_enrich.group.info.no_attributes_in_selected_locale'|trans }}
                        {% else %}
                            {{ 'pim_enrich.group.info.no_attributes'|trans }}
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    {% if comparisonLocale is not null %}
        {% include 'PimEnrichBundle:Product:_comparison-handler.html.twig' %}
    {% endif %}
</div>
